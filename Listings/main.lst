C51 COMPILER V9.54   MAIN                                                                  09/04/2025 18:39:10 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: E:\Learning Programs\kiel5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT
                    -(.\Listings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <REGX52.H>
   2          #include <LCD1602.h>
   3          #include <Delay.h>
   4          #include <Key.h>
   5          #include <AT2402.h>
   6          #include <XPT2046.h>
   7          #include <Timer0.h>
   8          #include <Timer1.h>
   9          #include <Timer2.h>
  10          #include <Buzzer.h>
  11          #include <Temp_Warn.h>
  12          #include <MOTOR_Monitor.h>
  13          #include <Menu.h>
  14          #include <Lux_Get.h>
  15          
  16          
  17          
  18          sbit ENA = P1^6;  
  19          sbit IN1 = P1^4;  
  20          sbit IN2 = P1^5;
  21          
  22          sbit XPT2046_CS=P3^5;
  23          sbit XPT2046_DCLK=P3^6;
  24          sbit XPT2046_DIN=P3^4;
  25          sbit XPT2046_DOUT=P3^7;
  26          
  27          const char* g_Messages[] = {
  28              "Warning Tem Set ",
  29              "Warning Lux Set ",
  30              "Motor_Speed Set ",   
  31                  "Auto Motor Mode ",
  32                  "                ",
  33          };  
  34          
  35          const unsigned int g_MessageCount=sizeof(g_Messages)/sizeof(g_Messages[0]);
  36            
  37          char  Compare=3;
  38          unsigned char Key_Num;
  39          unsigned char Lux;
  40          unsigned char ADValue;
  41          unsigned char auto_mode=0;
  42          unsigned char Menu_Syb=2;
  43          unsigned char Open_Motor=0;
  44          
  45          extern float NowTem;
  46          extern unsigned char Warning_TNum;
  47          extern unsigned int Warning_LHNum;
  48          extern unsigned int Warning_LLNum;
  49          extern unsigned char Buzzer_Flag;
  50          extern unsigned char Motor_Flag;
  51          extern unsigned char Motor_Start;
  52          
  53          
  54          
C51 COMPILER V9.54   MAIN                                                                  09/04/2025 18:39:10 PAGE 2   

  55          void main()
  56          {               
  57   1              LCD_Init();     
  58   1              Show_Menu_Start_Init();        //功能初始化开始
  59   1              Delay(3000);
  60   1              MOTOR_Monitor_Init();
  61   1              Timer1_Init();
*** WARNING C206 IN LINE 61 OF main.c: 'Timer1_Init': missing function-prototype
  62   1              //Timer2_Init();        
  63   1              
  64   1              DS18B20_ConvertT();
*** WARNING C206 IN LINE 64 OF main.c: 'DS18B20_ConvertT': missing function-prototype
  65   1              Delay(1000);    
  66   1              Temp_Set(27);
  67   1              Motor_Start=0;                //初始状态电机禁用
  68   1      
  69   1              Show_Menu_End_Init();          //功能初始化完成
  70   1              while(1)
  71   1              {       
  72   2                      Temp_Monitor();            //温度检测
  73   2                      Key_Num=Key();             //键码获取
  74   2      
  75   2                      Motor_Flag=Buzzer_Flag;
  76   2                      MOTOR_Monitor();           //电机控制
  77   2                      Lux=Lux_Get();          
  78   2              
  79   2                      if(Key_Num==4)
  80   2                      {
  81   3                              if(Menu_Syb==1)
  82   3                              {
  83   4                                      LCD_ShowString(1,1,"                "); 
  84   4                                      LCD_ShowString(2,1,"                "); 
  85   4                                      LCD_ShowString(1,1,g_Messages[0]);
  86   4                                      LCD_ShowString(2,1,g_Messages[1]);
  87   4                                      Show_Menu_Function();      //功能展示
  88   4                                      Menu_Syb=2;
  89   4                              }               
  90   3                              if(Menu_Syb==2)
  91   3                              {
  92   4                                      LCD_ShowString(1,1,"                "); 
  93   4                                      LCD_ShowString(2,1,"                "); 
  94   4                                      LCD_ShowString(1,1,"Now Temp:");
  95   4                                      LCD_ShowString(2,1,"Now Lux :");
  96   4                                      LCD_ShowNum(1,11,NowTem,3);
  97   4                                      LCD_ShowNum(2,11,Lux,3);
  98   4                                      Menu_Syb=1;
  99   4                              }
 100   3                      }
 101   2                      //Key_Num=Key();        
 102   2                      LCD_ShowString(1,1,"Now Temp:");
 103   2                      LCD_ShowString(2,1,"Now Lux :");
 104   2                      LCD_ShowNum(1,11,NowTem,3);
 105   2                      LCD_ShowNum(2,11,Lux,3);
 106   2                      Menu_Syb=1;
 107   2                      /*if(Key_Num==3)
 108   2                      {
 109   2                              Open_Motor=~Open_Motor;
 110   2                      }*/
 111   2                      //Key_Num=Key();        
 112   2              }       
 113   1      }
 114          
C51 COMPILER V9.54   MAIN                                                                  09/04/2025 18:39:10 PAGE 3   

 115          
 116          
 117          void Timer1_Routine() interrupt 3
 118          {               
 119   1              
 120   1              static unsigned int T1Count,T2Count,T3Count;
 121   1              TL1 = 0x18;             
 122   1              TH1 = 0xFC;             
 123   1              T1Count++;
 124   1              T2Count++;
 125   1              if(T2Count>20)                                        //定时器扫描键码
 126   1              {
 127   2                      Key_Loop();
 128   2                      T2Count=0;
 129   2              }
 130   1              if(T1Count>=1000 && Buzzer_Flag==1 && Motor_Start==0 && Open_Motor==0)//蜂鸣器满足条件后开始报警
 131   1              {
 132   2                      T1Count=0;
 133   2                      Buzzer_tms(50);
 134   2              }       
 135   1              T3Count++;
 136   1              if(T3Count>20)                                        //产生PWM波
 137   1      
 138   1              {
 139   2                      static unsigned char Counter;
 140   2                      Counter++;
 141   2                      Counter%=10;
 142   2                      if(Counter<Compare  &&  Motor_Flag==1 && Motor_Start==1)
 143   2                              {
 144   3                                      ENA=1;
 145   3                              }
 146   2                      else if (Counter<Compare && Open_Motor)
 147   2                      {
 148   3                                      ENA=1;
 149   3                      }
 150   2                      else
 151   2                              {
 152   3                                      ENA=0;
 153   3                              }               
 154   2                      T3Count=0;
 155   2              }
 156   1              if(Key_Num==3)
 157   1              {
 158   2                      Open_Motor=~Open_Motor;
 159   2              }       
 160   1      }
 161          
 162          /*
 163          void Timer2_Routine() interrupt 5
 164          {
 165                  TL2=0xA4;               
 166                  TH2=0xFF;
 167                  
 168          }
 169          
 170          */


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    533    ----
   CONSTANT SIZE    =    105    ----
   XDATA SIZE       =   ----    ----
C51 COMPILER V9.54   MAIN                                                                  09/04/2025 18:39:10 PAGE 4   

   PDATA SIZE       =   ----    ----
   DATA SIZE        =     31    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)
